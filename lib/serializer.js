/**
 * @fileoverview
 * @author Taketoshi Aono
 */
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var utils_1 = require("./utils");
var ProcessingType;
(function (ProcessingType) {
    ProcessingType[ProcessingType["TEXT"] = 0] = "TEXT";
    ProcessingType[ProcessingType["ARRAY_BUFFER"] = 1] = "ARRAY_BUFFER";
})(ProcessingType = exports.ProcessingType || (exports.ProcessingType = {}));
var TraversalState;
(function (TraversalState) {
    TraversalState[TraversalState["OBJECT_ROOT"] = 1] = "OBJECT_ROOT";
    TraversalState[TraversalState["OBJECT_PROPERTY_START"] = 2] = "OBJECT_PROPERTY_START";
    TraversalState[TraversalState["OBJECT_PROPERTY_END"] = 3] = "OBJECT_PROPERTY_END";
    TraversalState[TraversalState["ARRAY_ROOT"] = 4] = "ARRAY_ROOT";
    TraversalState[TraversalState["ARRAY_ELEMENT_START"] = 5] = "ARRAY_ELEMENT_START";
    TraversalState[TraversalState["ARRAY_ELEMENT_END"] = 6] = "ARRAY_ELEMENT_END";
    TraversalState[TraversalState["ROOT"] = 7] = "ROOT";
})(TraversalState || (TraversalState = {}));
var ContextState;
(function (ContextState) {
    ContextState[ContextState["OBJECT_PREPARE"] = 1] = "OBJECT_PREPARE";
    ContextState[ContextState["OBJECT_PROPERTY_ENUMERATION"] = 2] = "OBJECT_PROPERTY_ENUMERATION";
    ContextState[ContextState["ARRAY"] = 3] = "ARRAY";
    ContextState[ContextState["ORDINAL"] = 4] = "ORDINAL";
})(ContextState || (ContextState = {}));
var StackFrame = (function () {
    function StackFrame() {
        this.vp = [];
        this.cp = [];
        this.csp = [];
        this.ip = [];
        this.ip.push(TraversalState.OBJECT_ROOT);
    }
    StackFrame.prototype.pushIP = function (state) {
        this.ip.push(state);
    };
    StackFrame.prototype.popIP = function () {
        return this.ip.pop();
    };
    StackFrame.prototype.peekIP = function () { return this.ip[this.ip.length - 1]; };
    StackFrame.prototype.pushCP = function (value) {
        this.cp.push(value);
    };
    StackFrame.prototype.popCP = function () {
        return this.cp.pop();
    };
    StackFrame.prototype.peekCP = function () { return this.cp[this.cp.length - 1]; };
    StackFrame.prototype.pushCSP = function (value) {
        this.csp.push(value);
    };
    StackFrame.prototype.popCSP = function () {
        return this.csp.pop();
    };
    StackFrame.prototype.peekCSP = function () { return this.csp[this.csp.length - 1]; };
    StackFrame.prototype.exchangeCSP = function (state) {
        var last = this.csp.pop();
        this.csp.push(state);
        return last;
    };
    StackFrame.prototype.exchangeIP = function (state) {
        var ret = this.ip.pop();
        this.ip.push(state);
        return ret;
    };
    StackFrame.prototype.pushVP = function (value) {
        this.vp.push(value);
    };
    StackFrame.prototype.popVP = function () {
        return this.vp.pop();
    };
    StackFrame.prototype.peekVP = function () { return this.vp[this.vp.length - 1]; };
    StackFrame.prototype.exchangeVP = function (value) {
        var ret = this.vp.pop();
        this.vp.push(value);
        return ret;
    };
    Object.defineProperty(StackFrame.prototype, "ipLength", {
        get: function () { return this.ip.length; },
        enumerable: true,
        configurable: true
    });
    return StackFrame;
}());
var ObjectKeyDescriptorGetter = (function () {
    function ObjectKeyDescriptorGetter() {
    }
    ObjectKeyDescriptorGetter.getDescriptors = function (obj) {
        var proto = obj;
        var descriptors = [];
        while (proto) {
            var names = Object.getOwnPropertyNames(proto);
            for (var _i = 0, names_1 = names; _i < names_1.length; _i++) {
                var name_1 = names_1[_i];
                var descriptor = Object.getOwnPropertyDescriptor(proto, name_1);
                if (!this.isBuiltin(name_1, descriptor)) {
                    descriptors.push({ name: name_1, descriptor: descriptor });
                }
            }
            proto = Object.getPrototypeOf(proto);
        }
        return descriptors;
    };
    ObjectKeyDescriptorGetter.isBuiltin = function (key, _a) {
        var value = _a.value;
        return key === '__proto__' || (key in Object.prototype && Object.prototype[key] === value);
    };
    return ObjectKeyDescriptorGetter;
}());
var StateSentinel = (function () {
    function StateSentinel() {
    }
    return StateSentinel;
}());
/**
 * Traverse Object
 * Format:
 * {
 *   type: string // type name,
 *   value?: any // value,
 *   descriptors: {
 *     name: {
 *       configurable: boolean;
 *       enumerable: boolean;
 *       writable?: boolean;
 *       value?: any;
 *       get?: any;
 *       set?: any
 *     },
 *     ...
 *   }
 * }
 */
var ObjectTraversal = (function () {
    function ObjectTraversal() {
        this.stateSentinel = new StateSentinel();
        this.stack = new StackFrame();
    }
    ObjectTraversal.prototype.traverse = function (obj) {
        this.stack.pushVP(obj);
        while (this.stack.ipLength) {
            console.log(this.stack);
            switch (this.stack.popIP()) {
                case TraversalState.OBJECT_ROOT: {
                    this.handleRootState(this.stack.peekVP());
                    break;
                }
                case TraversalState.OBJECT_PROPERTY_START: {
                    var ret = this.handleObjectProperty();
                    if (ret.state) {
                        this.stack.pushIP(ret.state);
                    }
                    if (ret.value) {
                        this.stack.pushVP(ret.value);
                    }
                    break;
                }
                case TraversalState.OBJECT_PROPERTY_END: {
                    this.stack.popCSP();
                    this.stack.popCP();
                    var ret = [];
                    var sp = this.stack.popVP();
                    while (1) {
                        ret.push(sp);
                        sp = this.stack.popVP();
                        if (sp === this.stateSentinel) {
                            var result = "{\n              \"type\": \"object\",\n              \"descriptors\": {\n                " + ret.join(',\n') + "\n              }\n            }";
                            if (this.stack.peekCSP() === ContextState.OBJECT_PROPERTY_ENUMERATION) {
                                var name_2 = this.stack.peekCP().descriptorInfo.name;
                                this.stack.pushVP(null);
                                this.handlePrimitiveSerialization(result, function (v) { return v; });
                                result = this.stack.popVP();
                            }
                            this.stack.pushVP(result);
                            break;
                        }
                    }
                    break;
                }
                case TraversalState.ARRAY_ELEMENT_START: {
                    var array = this.stack.peekCP();
                    if (array.length) {
                        var element = array.pop();
                        this.stack.pushIP(TraversalState.ARRAY_ELEMENT_START);
                        this.stack.pushVP(element);
                        this.stack.pushIP(TraversalState.OBJECT_ROOT);
                    }
                    else {
                        this.stack.pushIP(TraversalState.ARRAY_ELEMENT_END);
                    }
                    break;
                }
                case TraversalState.ARRAY_ELEMENT_END: {
                    this.stack.popCP();
                    this.stack.popCSP();
                    var ret = [];
                    var sp = this.stack.popVP();
                    while (1) {
                        if (sp === this.stateSentinel) {
                            var value = void 0;
                            if (this.stack.peekCSP() === ContextState.OBJECT_PROPERTY_ENUMERATION) {
                                var name_3 = this.stack.peekCP().descriptorInfo.name;
                                this.stack.pushVP(null);
                                this.handlePrimitiveSerialization("[" + ret.join(',') + "]", function (v) { return v; });
                                value = this.stack.popVP();
                            }
                            else {
                                value = "[" + ret.join(',') + "]";
                            }
                            this.stack.pushVP(value);
                            break;
                        }
                        else {
                            ret.push(sp);
                        }
                        sp = this.stack.popVP();
                    }
                    break;
                }
            }
        }
        return this.stack.popVP();
    };
    ObjectTraversal.prototype.handleRootState = function (obj) {
        var _this = this;
        var type = utils_1.Reflect.className(obj);
        switch (type) {
            case 'object':
                var descriptors = ObjectKeyDescriptorGetter.getDescriptors(obj);
                this.stack.pushIP(TraversalState.OBJECT_PROPERTY_START);
                this.stack.exchangeVP(this.stateSentinel);
                this.stack.pushCP({ descriptors: descriptors, object: obj });
                this.stack.pushCSP(ContextState.OBJECT_PREPARE);
                break;
            case 'array':
                this.stack.exchangeVP(this.stateSentinel);
                this.stack.pushIP(TraversalState.ARRAY_ELEMENT_START);
                this.stack.pushCP(obj);
                this.stack.pushCSP(ContextState.ARRAY);
                break;
            case 'function':
                this.handlePrimitiveSerialization(obj, function (o) { return _this.serializeFunction(o); });
                break;
            case 'regexp':
                this.handlePrimitiveSerialization(obj, function (o) { return _this.serializeRegexp(o); });
                break;
            case 'string':
                this.handlePrimitiveSerialization(obj, function (o) { return "${o}"; });
                break;
            case 'number':
            case 'boolean':
                this.handlePrimitiveSerialization(obj, function (o) { return o; });
                break;
            default:
        }
    };
    ObjectTraversal.prototype.handleObjectProperty = function () {
        var descriptorInfo;
        if (this.stack.peekCSP() !== ContextState.OBJECT_PROPERTY_ENUMERATION) {
            var cp = this.stack.popCP();
            descriptorInfo = cp.descriptors.pop();
            this.stack.pushCP({ descriptorInfo: descriptorInfo, keyDescriptors: cp });
            this.stack.exchangeCSP(ContextState.OBJECT_PROPERTY_ENUMERATION);
        }
        else {
            var keyDescriptors = this.stack.popCP().keyDescriptors;
            descriptorInfo = keyDescriptors.descriptors.pop();
            this.stack.pushCP({ descriptorInfo: descriptorInfo, keyDescriptors: keyDescriptors });
        }
        if (descriptorInfo && descriptorInfo.descriptor) {
            this.stack.pushIP(TraversalState.OBJECT_PROPERTY_START);
            if (descriptorInfo.descriptor.value) {
                return { value: descriptorInfo.descriptor.value, state: TraversalState.OBJECT_ROOT };
            }
            return {
                value: "\"" + descriptorInfo.name + "\": {\n          \"configurable\": " + descriptorInfo.descriptor.configurable + ",\n          \"enumerable\": " + descriptorInfo.descriptor.enumerable + ",\n          \"set\": " + this.serializeFunction(descriptorInfo.descriptor.set) + ",\n          \"get\": " + this.serializeFunction(descriptorInfo.descriptor.get) + "\n        }",
                state: null
            };
        }
        return { value: null, state: TraversalState.OBJECT_PROPERTY_END };
    };
    ObjectTraversal.prototype.serializeFunction = function (fn) {
        if (fn) {
            var str = Function.prototype.toString.call(fn).replace(/\n\s/g, '');
            if (/^function(){[native code]}$/.test(str)) {
                return 'function() {throw new Error("Native function or bound function can\'t serialize.")}';
            }
            return "\"" + str + "\"";
        }
        return null;
    };
    ObjectTraversal.prototype.serializeRegexp = function (regexp) {
        return "{\"type\":\"regexp\", \"value\": \"/" + regexp.source + "/" + regexp.flags + "\"}";
    };
    /**
     * Serialize primitive values.
     * RETURN last vp
     */
    ObjectTraversal.prototype.handlePrimitiveSerialization = function (obj, serialize) {
        switch (this.stack.peekCSP()) {
            case ContextState.OBJECT_PROPERTY_ENUMERATION: {
                var descriptorInfo = this.stack.peekCP().descriptorInfo;
                var ret = ("\"" + descriptorInfo.name + "\": {\n        \"configurable\": " + descriptorInfo.descriptor.configurable + ",\n        \"enumerable\": " + descriptorInfo.descriptor.enumerable + ",\n        \"writable\": " + descriptorInfo.descriptor.writable + ",\n        \"value\": " + serialize(obj) + "\n      }").replace(/\s/g, '');
                this.stack.exchangeVP(ret);
                break;
            }
            case ContextState.ARRAY:
            case ContextState.ORDINAL: {
                this.stack.exchangeVP(serialize(obj));
                break;
            }
        }
    };
    return ObjectTraversal;
}());
exports.ObjectTraversal = ObjectTraversal;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcmlhbGl6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztHQUdHOzs7QUFHSCxpQ0FJaUI7QUFRakIsSUFBWSxjQUdYO0FBSEQsV0FBWSxjQUFjO0lBQ3hCLG1EQUFJLENBQUE7SUFDSixtRUFBWSxDQUFBO0FBQ2QsQ0FBQyxFQUhXLGNBQWMsR0FBZCxzQkFBYyxLQUFkLHNCQUFjLFFBR3pCO0FBTUQsSUFBSyxjQVFKO0FBUkQsV0FBSyxjQUFjO0lBQ2pCLGlFQUFlLENBQUE7SUFDZixxRkFBcUIsQ0FBQTtJQUNyQixpRkFBbUIsQ0FBQTtJQUNuQiwrREFBVSxDQUFBO0lBQ1YsaUZBQW1CLENBQUE7SUFDbkIsNkVBQWlCLENBQUE7SUFDakIsbURBQUksQ0FBQTtBQUNOLENBQUMsRUFSSSxjQUFjLEtBQWQsY0FBYyxRQVFsQjtBQUVELElBQUssWUFLSjtBQUxELFdBQUssWUFBWTtJQUNmLG1FQUFrQixDQUFBO0lBQ2xCLDZGQUEyQixDQUFBO0lBQzNCLGlEQUFLLENBQUE7SUFDTCxxREFBTyxDQUFBO0FBQ1QsQ0FBQyxFQUxJLFlBQVksS0FBWixZQUFZLFFBS2hCO0FBR0Q7SUFNRTtRQUxRLE9BQUUsR0FBVSxFQUFFLENBQUM7UUFDZixPQUFFLEdBQVUsRUFBRSxDQUFDO1FBQ2YsUUFBRyxHQUFtQixFQUFFLENBQUM7UUFDekIsT0FBRSxHQUFxQixFQUFFLENBQUM7UUFHaEMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQzNDLENBQUM7SUFFTSwyQkFBTSxHQUFiLFVBQWMsS0FBcUI7UUFDakMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUVNLDBCQUFLLEdBQVo7UUFDRSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRU0sMkJBQU0sR0FBYixjQUFpQixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUM7SUFHN0MsMkJBQU0sR0FBYixVQUFjLEtBQVU7UUFDdEIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUVNLDBCQUFLLEdBQVo7UUFDRSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRU0sMkJBQU0sR0FBYixjQUFpQixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUM7SUFHN0MsNEJBQU8sR0FBZCxVQUFlLEtBQW1CO1FBQ2hDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7SUFFTSwyQkFBTSxHQUFiO1FBQ0UsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDeEIsQ0FBQztJQUVNLDRCQUFPLEdBQWQsY0FBZ0MsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUEsQ0FBQSxDQUFDO0lBRTlELGdDQUFXLEdBQWxCLFVBQW1CLEtBQW1CO1FBQ3BDLElBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7UUFDNUIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckIsTUFBTSxDQUFDLElBQUksQ0FBQztJQUNkLENBQUM7SUFFTSwrQkFBVSxHQUFqQixVQUFrQixLQUFxQjtRQUNyQyxJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzFCLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3BCLE1BQU0sQ0FBQyxHQUFHLENBQUM7SUFDYixDQUFDO0lBR00sMkJBQU0sR0FBYixVQUFjLEtBQVU7UUFDdEIsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdEIsQ0FBQztJQUVNLDBCQUFLLEdBQVo7UUFDRSxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN2QixDQUFDO0lBRU0sMkJBQU0sR0FBYixjQUFzQixNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQSxDQUFBLENBQUM7SUFFbEQsK0JBQVUsR0FBakIsVUFBa0IsS0FBVTtRQUMxQixJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzFCLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3BCLE1BQU0sQ0FBQyxHQUFHLENBQUM7SUFDYixDQUFDO0lBRUQsc0JBQVcsZ0NBQVE7YUFBbkIsY0FBdUIsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUEsQ0FBQzs7O09BQUE7SUFDaEQsaUJBQUM7QUFBRCxDQXhFQSxBQXdFQyxJQUFBO0FBR0Q7SUFBQTtJQXFCQSxDQUFDO0lBcEJlLHdDQUFjLEdBQTVCLFVBQTZCLEdBQUc7UUFDOUIsSUFBSSxLQUFLLEdBQUcsR0FBRyxDQUFDO1FBQ2hCLElBQUksV0FBVyxHQUFHLEVBQUUsQ0FBQztRQUNyQixPQUFPLEtBQUssRUFBRSxDQUFDO1lBQ2IsSUFBTSxLQUFLLEdBQUcsTUFBTSxDQUFDLG1CQUFtQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBQ2hELEdBQUcsQ0FBQyxDQUFlLFVBQUssRUFBTCxlQUFLLEVBQUwsbUJBQUssRUFBTCxJQUFLO2dCQUFuQixJQUFNLE1BQUksY0FBQTtnQkFDYixJQUFNLFVBQVUsR0FBRyxNQUFNLENBQUMsd0JBQXdCLENBQUMsS0FBSyxFQUFFLE1BQUksQ0FBQyxDQUFDO2dCQUNoRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsTUFBSSxFQUFFLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDdEMsV0FBVyxDQUFDLElBQUksQ0FBQyxFQUFDLElBQUksUUFBQSxFQUFFLFVBQVUsWUFBQSxFQUFDLENBQUMsQ0FBQztnQkFDdkMsQ0FBQzthQUNGO1lBQ0QsS0FBSyxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdkMsQ0FBQztRQUNELE1BQU0sQ0FBQyxXQUFXLENBQUM7SUFDckIsQ0FBQztJQUdjLG1DQUFTLEdBQXhCLFVBQXlCLEdBQVcsRUFBRSxFQUFzQjtZQUFyQixnQkFBSztRQUMxQyxNQUFNLENBQUMsR0FBRyxLQUFLLFdBQVcsSUFBSSxDQUFDLEdBQUcsSUFBSSxNQUFNLENBQUMsU0FBUyxJQUFJLE1BQU0sQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLEtBQUssS0FBSyxDQUFDLENBQUM7SUFDN0YsQ0FBQztJQUNILGdDQUFDO0FBQUQsQ0FyQkEsQUFxQkMsSUFBQTtBQUdEO0lBQUE7SUFDQSxDQUFDO0lBQUQsb0JBQUM7QUFBRCxDQURBLEFBQ0MsSUFBQTtBQUdEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FrQkc7QUFDSDtJQUtFO1FBRlEsa0JBQWEsR0FBRyxJQUFJLGFBQWEsRUFBRSxDQUFDO1FBRzFDLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxVQUFVLEVBQUUsQ0FBQztJQUNoQyxDQUFDO0lBRU0sa0NBQVEsR0FBZixVQUFnQixHQUFRO1FBQ3RCLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZCLE9BQU8sSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUMzQixPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUN4QixNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsQ0FBQztnQkFDN0IsS0FBSyxjQUFjLENBQUMsV0FBVyxFQUFFLENBQUM7b0JBQ2hDLElBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDO29CQUMxQyxLQUFLLENBQUM7Z0JBQ1IsQ0FBQztnQkFDRCxLQUFLLGNBQWMsQ0FBQyxxQkFBcUIsRUFBRSxDQUFDO29CQUMxQyxJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsb0JBQW9CLEVBQUUsQ0FBQztvQkFDeEMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7d0JBQ2QsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxDQUFDO29CQUMvQixDQUFDO29CQUNELEVBQUUsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO3dCQUNkLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsQ0FBQztvQkFDL0IsQ0FBQztvQkFDRCxLQUFLLENBQUM7Z0JBQ1IsQ0FBQztnQkFDRCxLQUFLLGNBQWMsQ0FBQyxtQkFBbUIsRUFBRSxDQUFDO29CQUN4QyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sRUFBRSxDQUFDO29CQUNwQixJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUNuQixJQUFNLEdBQUcsR0FBRyxFQUFFLENBQUM7b0JBQ2YsSUFBSSxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztvQkFDNUIsT0FBTyxDQUFDLEVBQUUsQ0FBQzt3QkFDVCxHQUFHLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO3dCQUNiLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO3dCQUN4QixFQUFFLENBQUMsQ0FBQyxFQUFFLEtBQUssSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUM7NEJBQzlCLElBQUksTUFBTSxHQUFHLCtGQUdQLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLHFDQUVuQixDQUFDOzRCQUNILEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssWUFBWSxDQUFDLDJCQUEyQixDQUFDLENBQUMsQ0FBQztnQ0FDOUMsSUFBQSxnREFBSSxDQUF5QjtnQ0FDckQsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLENBQUM7Z0NBQ3hCLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxNQUFNLEVBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLEVBQUQsQ0FBQyxDQUFDLENBQUM7Z0NBQ2xELE1BQU0sR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDOzRCQUM5QixDQUFDOzRCQUNELElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDOzRCQUMxQixLQUFLLENBQUM7d0JBQ1IsQ0FBQztvQkFDSCxDQUFDO29CQUNELEtBQUssQ0FBQztnQkFDUixDQUFDO2dCQUNELEtBQUssY0FBYyxDQUFDLG1CQUFtQixFQUFFLENBQUM7b0JBQ3hDLElBQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7b0JBQ2xDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO3dCQUNqQixJQUFNLE9BQU8sR0FBRyxLQUFLLENBQUMsR0FBRyxFQUFFLENBQUM7d0JBQzVCLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO3dCQUN0RCxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQzt3QkFDM0IsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLFdBQVcsQ0FBQyxDQUFDO29CQUNoRCxDQUFDO29CQUFDLElBQUksQ0FBQyxDQUFDO3dCQUNOLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO29CQUN0RCxDQUFDO29CQUNELEtBQUssQ0FBQztnQkFDUixDQUFDO2dCQUNELEtBQUssY0FBYyxDQUFDLGlCQUFpQixFQUFFLENBQUM7b0JBQ3RDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUM7b0JBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7b0JBQ3BCLElBQU0sR0FBRyxHQUFHLEVBQUUsQ0FBQztvQkFDZixJQUFJLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUM1QixPQUFPLENBQUMsRUFBRSxDQUFDO3dCQUNULEVBQUUsQ0FBQyxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQzs0QkFDOUIsSUFBSSxLQUFLLFNBQUEsQ0FBQzs0QkFDVixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxLQUFLLFlBQVksQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLENBQUM7Z0NBQzlDLElBQUEsZ0RBQUksQ0FBeUI7Z0NBQ3JELElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO2dDQUN4QixJQUFJLENBQUMsNEJBQTRCLENBQUMsTUFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxNQUFHLEVBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxDQUFDLEVBQUQsQ0FBQyxDQUFDLENBQUM7Z0NBQ2hFLEtBQUssR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDOzRCQUM3QixDQUFDOzRCQUFDLElBQUksQ0FBQyxDQUFDO2dDQUNOLEtBQUssR0FBRyxNQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQUcsQ0FBQzs0QkFDL0IsQ0FBQzs0QkFDRCxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQzs0QkFDekIsS0FBSyxDQUFDO3dCQUNSLENBQUM7d0JBQUMsSUFBSSxDQUFDLENBQUM7NEJBQ04sR0FBRyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQzt3QkFDZixDQUFDO3dCQUNELEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLEtBQUssRUFBRSxDQUFDO29CQUMxQixDQUFDO29CQUNELEtBQUssQ0FBQztnQkFDUixDQUFDO1lBQ0QsQ0FBQztRQUNILENBQUM7UUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztJQUM1QixDQUFDO0lBR08seUNBQWUsR0FBdkIsVUFBd0IsR0FBRztRQUEzQixpQkErQkM7UUE5QkMsSUFBTSxJQUFJLEdBQUcsZUFBTyxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNwQyxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQ2YsS0FBSyxRQUFRO2dCQUNYLElBQU0sV0FBVyxHQUFHLHlCQUF5QixDQUFDLGNBQWMsQ0FBQyxHQUFHLENBQUMsQ0FBQztnQkFDbEUsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLHFCQUFxQixDQUFDLENBQUM7Z0JBQ3hELElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FBQztnQkFDMUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsRUFBQyxXQUFXLGFBQUEsRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQztnQkFDOUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsWUFBWSxDQUFDLGNBQWMsQ0FBQyxDQUFDO2dCQUNoRCxLQUFLLENBQUM7WUFDUixLQUFLLE9BQU87Z0JBQ1YsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO2dCQUMxQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsbUJBQW1CLENBQUMsQ0FBQztnQkFDdEQsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQ3ZCLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDdkMsS0FBSyxDQUFDO1lBQ1IsS0FBSyxVQUFVO2dCQUNiLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxHQUFHLEVBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxLQUFJLENBQUMsaUJBQWlCLENBQUMsQ0FBQyxDQUFDLEVBQXpCLENBQXlCLENBQUMsQ0FBQztnQkFDdkUsS0FBSyxDQUFDO1lBQ1IsS0FBSyxRQUFRO2dCQUNYLElBQUksQ0FBQyw0QkFBNEIsQ0FBQyxHQUFHLEVBQUUsVUFBQSxDQUFDLElBQUksT0FBQSxLQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxFQUF2QixDQUF1QixDQUFDLENBQUM7Z0JBQ3JFLEtBQUssQ0FBQztZQUNSLEtBQUssUUFBUTtnQkFDWCxJQUFJLENBQUMsNEJBQTRCLENBQUMsR0FBRyxFQUFFLFVBQUEsQ0FBQyxJQUFJLE9BQUEsTUFBTSxFQUFOLENBQU0sQ0FBQyxDQUFDO2dCQUNwRCxLQUFLLENBQUM7WUFDUixLQUFLLFFBQVEsQ0FBQztZQUNkLEtBQUssU0FBUztnQkFDWixJQUFJLENBQUMsNEJBQTRCLENBQUMsR0FBRyxFQUFFLFVBQUEsQ0FBQyxJQUFJLE9BQUEsQ0FBQyxFQUFELENBQUMsQ0FBQyxDQUFDO2dCQUMvQyxLQUFLLENBQUM7WUFDUixRQUFRO1FBQ1IsQ0FBQztJQUNILENBQUM7SUFHTyw4Q0FBb0IsR0FBNUI7UUFDRSxJQUFJLGNBQWMsQ0FBQztRQUNuQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxLQUFLLFlBQVksQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLENBQUM7WUFDdEUsSUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQztZQUM5QixjQUFjLEdBQUcsRUFBRSxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztZQUN0QyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxFQUFDLGNBQWMsZ0JBQUEsRUFBRSxjQUFjLEVBQUUsRUFBRSxFQUFDLENBQUMsQ0FBQztZQUN4RCxJQUFJLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsMkJBQTJCLENBQUMsQ0FBQztRQUNuRSxDQUFDO1FBQUMsSUFBSSxDQUFDLENBQUM7WUFDQyxJQUFBLGtEQUFjLENBQXVCO1lBQzVDLGNBQWMsR0FBRyxjQUFjLENBQUMsV0FBVyxDQUFDLEdBQUcsRUFBRSxDQUFDO1lBQ2xELElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxDQUFDLEVBQUMsY0FBYyxnQkFBQSxFQUFFLGNBQWMsZ0JBQUEsRUFBQyxDQUFDLENBQUM7UUFDdEQsQ0FBQztRQUVELEVBQUUsQ0FBQyxDQUFDLGNBQWMsSUFBSSxjQUFjLENBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQztZQUNoRCxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMscUJBQXFCLENBQUMsQ0FBQztZQUN4RCxFQUFFLENBQUMsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7Z0JBQ3BDLE1BQU0sQ0FBQyxFQUFDLEtBQUssRUFBRSxjQUFjLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsY0FBYyxDQUFDLFdBQVcsRUFBQyxDQUFDO1lBQ3JGLENBQUM7WUFDRCxNQUFNLENBQUM7Z0JBQ0wsS0FBSyxFQUFFLE9BQUksY0FBYyxDQUFDLElBQUksMkNBQ1YsY0FBYyxDQUFDLFVBQVUsQ0FBQyxZQUFZLHFDQUN4QyxjQUFjLENBQUMsVUFBVSxDQUFDLFVBQVUsOEJBQzNDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLEdBQUcsQ0FBQyw4QkFDckQsSUFBSSxDQUFDLGlCQUFpQixDQUFDLGNBQWMsQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLGdCQUM5RDtnQkFDRixLQUFLLEVBQUUsSUFBSTthQUNaLENBQUM7UUFDSixDQUFDO1FBQ0QsTUFBTSxDQUFDLEVBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsY0FBYyxDQUFDLG1CQUFtQixFQUFDLENBQUM7SUFDbEUsQ0FBQztJQUdPLDJDQUFpQixHQUF6QixVQUEwQixFQUFZO1FBQ3BDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDUCxJQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztZQUN0RSxFQUFFLENBQUMsQ0FBQyw2QkFBNkIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO2dCQUM1QyxNQUFNLENBQUMscUZBQXFGLENBQUE7WUFDOUYsQ0FBQztZQUNELE1BQU0sQ0FBQyxPQUFJLEdBQUcsT0FBRyxDQUFDO1FBQ3BCLENBQUM7UUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQUVPLHlDQUFlLEdBQXZCLFVBQXdCLE1BQWM7UUFDcEMsTUFBTSxDQUFDLHlDQUFnQyxNQUFNLENBQUMsTUFBTSxTQUFJLE1BQU0sQ0FBQyxLQUFLLFFBQUksQ0FBQTtJQUMxRSxDQUFDO0lBR0Q7OztPQUdHO0lBQ0ssc0RBQTRCLEdBQXBDLFVBQXFDLEdBQVEsRUFBRSxTQUE2QjtRQUMxRSxNQUFNLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUMsQ0FBQztZQUMvQixLQUFLLFlBQVksQ0FBQywyQkFBMkIsRUFBRSxDQUFDO2dCQUN2QyxJQUFBLG1EQUFjLENBQXdCO2dCQUM3QyxJQUFNLEdBQUcsR0FBRyxDQUFBLE9BQUksY0FBYyxDQUFDLElBQUkseUNBQ2YsY0FBYyxDQUFDLFVBQVUsQ0FBQyxZQUFZLG1DQUN4QyxjQUFjLENBQUMsVUFBVSxDQUFDLFVBQVUsaUNBQ3RDLGNBQWMsQ0FBQyxVQUFVLENBQUMsUUFBUSw4QkFDckMsU0FBUyxDQUFDLEdBQUcsQ0FBQyxjQUN6QixDQUFBLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsQ0FBQztnQkFDdEIsSUFBSSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsR0FBRyxDQUFDLENBQUM7Z0JBQzNCLEtBQUssQ0FBQztZQUNSLENBQUM7WUFDRCxLQUFLLFlBQVksQ0FBQyxLQUFLLENBQUM7WUFDeEIsS0FBSyxZQUFZLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBQzFCLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDLFNBQVMsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO2dCQUN0QyxLQUFLLENBQUM7WUFDUixDQUFDO1FBQ0QsQ0FBQztJQUNILENBQUM7SUFDSCxzQkFBQztBQUFELENBNU1BLEFBNE1DLElBQUE7QUE1TVksMENBQWUiLCJmaWxlIjoic2VyaWFsaXplci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQGZpbGVvdmVydmlld1xuICogQGF1dGhvciBUYWtldG9zaGkgQW9ub1xuICovXG5cblxuaW1wb3J0IHtcbiAgUmVmbGVjdCxcbiAgcmVjdXJzaXZlLFxuICBvclxufSBmcm9tICcuL3V0aWxzJztcblxuXG5leHBvcnQgaW50ZXJmYWNlIFNlcmlhbGl6ZXIge1xuICBcbn1cblxuXG5leHBvcnQgZW51bSBQcm9jZXNzaW5nVHlwZSB7XG4gIFRFWFQsXG4gIEFSUkFZX0JVRkZFUlxufVxuXG5cbnR5cGUgVHlwZXMgPSBBcnJheUJ1ZmZlcnxzdHJpbmd8T2JqZWN0O1xuXG5cbmVudW0gVHJhdmVyc2FsU3RhdGUge1xuICBPQkpFQ1RfUk9PVCA9IDEsXG4gIE9CSkVDVF9QUk9QRVJUWV9TVEFSVCxcbiAgT0JKRUNUX1BST1BFUlRZX0VORCxcbiAgQVJSQVlfUk9PVCxcbiAgQVJSQVlfRUxFTUVOVF9TVEFSVCxcbiAgQVJSQVlfRUxFTUVOVF9FTkQsXG4gIFJPT1Rcbn1cblxuZW51bSBDb250ZXh0U3RhdGUge1xuICBPQkpFQ1RfUFJFUEFSRSA9IDEsXG4gIE9CSkVDVF9QUk9QRVJUWV9FTlVNRVJBVElPTixcbiAgQVJSQVksXG4gIE9SRElOQUxcbn1cblxuXG5jbGFzcyBTdGFja0ZyYW1lIHtcbiAgcHJpdmF0ZSB2cDogYW55W10gPSBbXTtcbiAgcHJpdmF0ZSBjcDogYW55W10gPSBbXTtcbiAgcHJpdmF0ZSBjc3A6IENvbnRleHRTdGF0ZVtdID0gW107XG4gIHByaXZhdGUgaXA6IFRyYXZlcnNhbFN0YXRlW10gPSBbXTtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLmlwLnB1c2goVHJhdmVyc2FsU3RhdGUuT0JKRUNUX1JPT1QpO1xuICB9XG5cbiAgcHVibGljIHB1c2hJUChzdGF0ZTogVHJhdmVyc2FsU3RhdGUpIHtcbiAgICB0aGlzLmlwLnB1c2goc3RhdGUpO1xuICB9XG5cbiAgcHVibGljIHBvcElQKCk6IFRyYXZlcnNhbFN0YXRlIHtcbiAgICByZXR1cm4gdGhpcy5pcC5wb3AoKTtcbiAgfVxuXG4gIHB1YmxpYyBwZWVrSVAoKSB7cmV0dXJuIHRoaXMuaXBbdGhpcy5pcC5sZW5ndGggLSAxXX1cblxuICBcbiAgcHVibGljIHB1c2hDUCh2YWx1ZTogYW55KSB7XG4gICAgdGhpcy5jcC5wdXNoKHZhbHVlKTtcbiAgfVxuXG4gIHB1YmxpYyBwb3BDUCgpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLmNwLnBvcCgpO1xuICB9XG5cbiAgcHVibGljIHBlZWtDUCgpIHtyZXR1cm4gdGhpcy5jcFt0aGlzLmNwLmxlbmd0aCAtIDFdfVxuXG4gIFxuICBwdWJsaWMgcHVzaENTUCh2YWx1ZTogQ29udGV4dFN0YXRlKSB7XG4gICAgdGhpcy5jc3AucHVzaCh2YWx1ZSk7XG4gIH1cblxuICBwdWJsaWMgcG9wQ1NQKCk6IENvbnRleHRTdGF0ZSB7XG4gICAgcmV0dXJuIHRoaXMuY3NwLnBvcCgpO1xuICB9XG5cbiAgcHVibGljIHBlZWtDU1AoKTogQ29udGV4dFN0YXRlIHtyZXR1cm4gdGhpcy5jc3BbdGhpcy5jc3AubGVuZ3RoIC0gMV19XG5cbiAgcHVibGljIGV4Y2hhbmdlQ1NQKHN0YXRlOiBDb250ZXh0U3RhdGUpOiBDb250ZXh0U3RhdGUge1xuICAgIGNvbnN0IGxhc3QgPSB0aGlzLmNzcC5wb3AoKTtcbiAgICB0aGlzLmNzcC5wdXNoKHN0YXRlKTtcbiAgICByZXR1cm4gbGFzdDtcbiAgfVxuXG4gIHB1YmxpYyBleGNoYW5nZUlQKHN0YXRlOiBUcmF2ZXJzYWxTdGF0ZSk6IFRyYXZlcnNhbFN0YXRlIHtcbiAgICBjb25zdCByZXQgPSB0aGlzLmlwLnBvcCgpO1xuICAgIHRoaXMuaXAucHVzaChzdGF0ZSk7XG4gICAgcmV0dXJuIHJldDtcbiAgfVxuXG5cbiAgcHVibGljIHB1c2hWUCh2YWx1ZTogYW55KSB7XG4gICAgdGhpcy52cC5wdXNoKHZhbHVlKTtcbiAgfVxuXG4gIHB1YmxpYyBwb3BWUCgpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLnZwLnBvcCgpO1xuICB9XG5cbiAgcHVibGljIHBlZWtWUCgpOiBhbnkge3JldHVybiB0aGlzLnZwW3RoaXMudnAubGVuZ3RoIC0gMV19XG5cbiAgcHVibGljIGV4Y2hhbmdlVlAodmFsdWU6IGFueSk6IGFueSB7XG4gICAgY29uc3QgcmV0ID0gdGhpcy52cC5wb3AoKTtcbiAgICB0aGlzLnZwLnB1c2godmFsdWUpO1xuICAgIHJldHVybiByZXQ7XG4gIH1cblxuICBwdWJsaWMgZ2V0IGlwTGVuZ3RoKCkge3JldHVybiB0aGlzLmlwLmxlbmd0aDt9XG59XG5cblxuY2xhc3MgT2JqZWN0S2V5RGVzY3JpcHRvckdldHRlciB7XG4gIHB1YmxpYyBzdGF0aWMgZ2V0RGVzY3JpcHRvcnMob2JqKSB7XG4gICAgbGV0IHByb3RvID0gb2JqO1xuICAgIGxldCBkZXNjcmlwdG9ycyA9IFtdO1xuICAgIHdoaWxlIChwcm90bykge1xuICAgICAgY29uc3QgbmFtZXMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhwcm90byk7XG4gICAgICBmb3IgKGNvbnN0IG5hbWUgb2YgbmFtZXMpIHtcbiAgICAgICAgY29uc3QgZGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sIG5hbWUpO1xuICAgICAgICBpZiAoIXRoaXMuaXNCdWlsdGluKG5hbWUsIGRlc2NyaXB0b3IpKSB7XG4gICAgICAgICAgZGVzY3JpcHRvcnMucHVzaCh7bmFtZSwgZGVzY3JpcHRvcn0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBwcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZihwcm90byk7XG4gICAgfVxuICAgIHJldHVybiBkZXNjcmlwdG9ycztcbiAgfVxuXG5cbiAgcHJpdmF0ZSBzdGF0aWMgaXNCdWlsdGluKGtleTogc3RyaW5nLCB7dmFsdWV9OiB7dmFsdWU/OiBhbnl9KSB7XG4gICAgcmV0dXJuIGtleSA9PT0gJ19fcHJvdG9fXycgfHwgKGtleSBpbiBPYmplY3QucHJvdG90eXBlICYmIE9iamVjdC5wcm90b3R5cGVba2V5XSA9PT0gdmFsdWUpO1xuICB9XG59XG5cblxuY2xhc3MgU3RhdGVTZW50aW5lbCB7XG59XG5cblxuLyoqXG4gKiBUcmF2ZXJzZSBPYmplY3RcbiAqIEZvcm1hdDpcbiAqIHtcbiAqICAgdHlwZTogc3RyaW5nIC8vIHR5cGUgbmFtZSxcbiAqICAgdmFsdWU/OiBhbnkgLy8gdmFsdWUsXG4gKiAgIGRlc2NyaXB0b3JzOiB7XG4gKiAgICAgbmFtZToge1xuICogICAgICAgY29uZmlndXJhYmxlOiBib29sZWFuO1xuICogICAgICAgZW51bWVyYWJsZTogYm9vbGVhbjtcbiAqICAgICAgIHdyaXRhYmxlPzogYm9vbGVhbjtcbiAqICAgICAgIHZhbHVlPzogYW55O1xuICogICAgICAgZ2V0PzogYW55O1xuICogICAgICAgc2V0PzogYW55XG4gKiAgICAgfSxcbiAqICAgICAuLi5cbiAqICAgfVxuICogfVxuICovXG5leHBvcnQgY2xhc3MgT2JqZWN0VHJhdmVyc2FsIHtcbiAgcHJpdmF0ZSBzdGFjazogU3RhY2tGcmFtZTtcblxuICBwcml2YXRlIHN0YXRlU2VudGluZWwgPSBuZXcgU3RhdGVTZW50aW5lbCgpO1xuICBcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5zdGFjayA9IG5ldyBTdGFja0ZyYW1lKCk7XG4gIH1cbiAgXG4gIHB1YmxpYyB0cmF2ZXJzZShvYmo6IGFueSkge1xuICAgIHRoaXMuc3RhY2sucHVzaFZQKG9iaik7XG4gICAgd2hpbGUgKHRoaXMuc3RhY2suaXBMZW5ndGgpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMuc3RhY2spO1xuICAgICAgc3dpdGNoICh0aGlzLnN0YWNrLnBvcElQKCkpIHtcbiAgICAgIGNhc2UgVHJhdmVyc2FsU3RhdGUuT0JKRUNUX1JPT1Q6IHtcbiAgICAgICAgdGhpcy5oYW5kbGVSb290U3RhdGUodGhpcy5zdGFjay5wZWVrVlAoKSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgY2FzZSBUcmF2ZXJzYWxTdGF0ZS5PQkpFQ1RfUFJPUEVSVFlfU1RBUlQ6IHtcbiAgICAgICAgY29uc3QgcmV0ID0gdGhpcy5oYW5kbGVPYmplY3RQcm9wZXJ0eSgpO1xuICAgICAgICBpZiAocmV0LnN0YXRlKSB7XG4gICAgICAgICAgdGhpcy5zdGFjay5wdXNoSVAocmV0LnN0YXRlKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmV0LnZhbHVlKSB7XG4gICAgICAgICAgdGhpcy5zdGFjay5wdXNoVlAocmV0LnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIGNhc2UgVHJhdmVyc2FsU3RhdGUuT0JKRUNUX1BST1BFUlRZX0VORDoge1xuICAgICAgICB0aGlzLnN0YWNrLnBvcENTUCgpO1xuICAgICAgICB0aGlzLnN0YWNrLnBvcENQKCk7XG4gICAgICAgIGNvbnN0IHJldCA9IFtdO1xuICAgICAgICBsZXQgc3AgPSB0aGlzLnN0YWNrLnBvcFZQKCk7XG4gICAgICAgIHdoaWxlICgxKSB7XG4gICAgICAgICAgcmV0LnB1c2goc3ApO1xuICAgICAgICAgIHNwID0gdGhpcy5zdGFjay5wb3BWUCgpO1xuICAgICAgICAgIGlmIChzcCA9PT0gdGhpcy5zdGF0ZVNlbnRpbmVsKSB7XG4gICAgICAgICAgICBsZXQgcmVzdWx0ID0gYHtcbiAgICAgICAgICAgICAgXCJ0eXBlXCI6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgIFwiZGVzY3JpcHRvcnNcIjoge1xuICAgICAgICAgICAgICAgICR7cmV0LmpvaW4oJyxcXG4nKX1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfWA7XG4gICAgICAgICAgICBpZiAodGhpcy5zdGFjay5wZWVrQ1NQKCkgPT09IENvbnRleHRTdGF0ZS5PQkpFQ1RfUFJPUEVSVFlfRU5VTUVSQVRJT04pIHtcbiAgICAgICAgICAgICAgY29uc3Qge2Rlc2NyaXB0b3JJbmZvOiB7bmFtZX19ID0gdGhpcy5zdGFjay5wZWVrQ1AoKTtcbiAgICAgICAgICAgICAgdGhpcy5zdGFjay5wdXNoVlAobnVsbCk7XG4gICAgICAgICAgICAgIHRoaXMuaGFuZGxlUHJpbWl0aXZlU2VyaWFsaXphdGlvbihyZXN1bHQsIHYgPT4gdik7XG4gICAgICAgICAgICAgIHJlc3VsdCA9IHRoaXMuc3RhY2sucG9wVlAoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaFZQKHJlc3VsdCk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFRyYXZlcnNhbFN0YXRlLkFSUkFZX0VMRU1FTlRfU1RBUlQ6IHtcbiAgICAgICAgY29uc3QgYXJyYXkgPSB0aGlzLnN0YWNrLnBlZWtDUCgpO1xuICAgICAgICBpZiAoYXJyYXkubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc3QgZWxlbWVudCA9IGFycmF5LnBvcCgpO1xuICAgICAgICAgIHRoaXMuc3RhY2sucHVzaElQKFRyYXZlcnNhbFN0YXRlLkFSUkFZX0VMRU1FTlRfU1RBUlQpO1xuICAgICAgICAgIHRoaXMuc3RhY2sucHVzaFZQKGVsZW1lbnQpO1xuICAgICAgICAgIHRoaXMuc3RhY2sucHVzaElQKFRyYXZlcnNhbFN0YXRlLk9CSkVDVF9ST09UKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLnN0YWNrLnB1c2hJUChUcmF2ZXJzYWxTdGF0ZS5BUlJBWV9FTEVNRU5UX0VORCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICBjYXNlIFRyYXZlcnNhbFN0YXRlLkFSUkFZX0VMRU1FTlRfRU5EOiB7XG4gICAgICAgIHRoaXMuc3RhY2sucG9wQ1AoKTtcbiAgICAgICAgdGhpcy5zdGFjay5wb3BDU1AoKTtcbiAgICAgICAgY29uc3QgcmV0ID0gW107XG4gICAgICAgIGxldCBzcCA9IHRoaXMuc3RhY2sucG9wVlAoKTtcbiAgICAgICAgd2hpbGUgKDEpIHtcbiAgICAgICAgICBpZiAoc3AgPT09IHRoaXMuc3RhdGVTZW50aW5lbCkge1xuICAgICAgICAgICAgbGV0IHZhbHVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuc3RhY2sucGVla0NTUCgpID09PSBDb250ZXh0U3RhdGUuT0JKRUNUX1BST1BFUlRZX0VOVU1FUkFUSU9OKSB7XG4gICAgICAgICAgICAgIGNvbnN0IHtkZXNjcmlwdG9ySW5mbzoge25hbWV9fSA9IHRoaXMuc3RhY2sucGVla0NQKCk7XG4gICAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaFZQKG51bGwpO1xuICAgICAgICAgICAgICB0aGlzLmhhbmRsZVByaW1pdGl2ZVNlcmlhbGl6YXRpb24oYFske3JldC5qb2luKCcsJyl9XWAsIHYgPT4gdik7XG4gICAgICAgICAgICAgIHZhbHVlID0gdGhpcy5zdGFjay5wb3BWUCgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgdmFsdWUgPSBgWyR7cmV0LmpvaW4oJywnKX1dYDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuc3RhY2sucHVzaFZQKHZhbHVlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXQucHVzaChzcCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHNwID0gdGhpcy5zdGFjay5wb3BWUCgpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5zdGFjay5wb3BWUCgpO1xuICB9XG5cblxuICBwcml2YXRlIGhhbmRsZVJvb3RTdGF0ZShvYmopIHtcbiAgICBjb25zdCB0eXBlID0gUmVmbGVjdC5jbGFzc05hbWUob2JqKTtcbiAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlICdvYmplY3QnOlxuICAgICAgY29uc3QgZGVzY3JpcHRvcnMgPSBPYmplY3RLZXlEZXNjcmlwdG9yR2V0dGVyLmdldERlc2NyaXB0b3JzKG9iaik7XG4gICAgICB0aGlzLnN0YWNrLnB1c2hJUChUcmF2ZXJzYWxTdGF0ZS5PQkpFQ1RfUFJPUEVSVFlfU1RBUlQpO1xuICAgICAgdGhpcy5zdGFjay5leGNoYW5nZVZQKHRoaXMuc3RhdGVTZW50aW5lbCk7XG4gICAgICB0aGlzLnN0YWNrLnB1c2hDUCh7ZGVzY3JpcHRvcnMsIG9iamVjdDogb2JqfSk7XG4gICAgICB0aGlzLnN0YWNrLnB1c2hDU1AoQ29udGV4dFN0YXRlLk9CSkVDVF9QUkVQQVJFKTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ2FycmF5JzpcbiAgICAgIHRoaXMuc3RhY2suZXhjaGFuZ2VWUCh0aGlzLnN0YXRlU2VudGluZWwpO1xuICAgICAgdGhpcy5zdGFjay5wdXNoSVAoVHJhdmVyc2FsU3RhdGUuQVJSQVlfRUxFTUVOVF9TVEFSVCk7XG4gICAgICB0aGlzLnN0YWNrLnB1c2hDUChvYmopO1xuICAgICAgdGhpcy5zdGFjay5wdXNoQ1NQKENvbnRleHRTdGF0ZS5BUlJBWSk7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdmdW5jdGlvbic6XG4gICAgICB0aGlzLmhhbmRsZVByaW1pdGl2ZVNlcmlhbGl6YXRpb24ob2JqLCBvID0+IHRoaXMuc2VyaWFsaXplRnVuY3Rpb24obykpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAncmVnZXhwJzpcbiAgICAgIHRoaXMuaGFuZGxlUHJpbWl0aXZlU2VyaWFsaXphdGlvbihvYmosIG8gPT4gdGhpcy5zZXJpYWxpemVSZWdleHAobykpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgIHRoaXMuaGFuZGxlUHJpbWl0aXZlU2VyaWFsaXphdGlvbihvYmosIG8gPT4gXCIke299XCIpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICBjYXNlICdib29sZWFuJzpcbiAgICAgIHRoaXMuaGFuZGxlUHJpbWl0aXZlU2VyaWFsaXphdGlvbihvYmosIG8gPT4gbyk7XG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgIH1cbiAgfVxuXG5cbiAgcHJpdmF0ZSBoYW5kbGVPYmplY3RQcm9wZXJ0eSgpIHtcbiAgICBsZXQgZGVzY3JpcHRvckluZm87XG4gICAgaWYgKHRoaXMuc3RhY2sucGVla0NTUCgpICE9PSBDb250ZXh0U3RhdGUuT0JKRUNUX1BST1BFUlRZX0VOVU1FUkFUSU9OKSB7XG4gICAgICBjb25zdCBjcCA9IHRoaXMuc3RhY2sucG9wQ1AoKTtcbiAgICAgIGRlc2NyaXB0b3JJbmZvID0gY3AuZGVzY3JpcHRvcnMucG9wKCk7XG4gICAgICB0aGlzLnN0YWNrLnB1c2hDUCh7ZGVzY3JpcHRvckluZm8sIGtleURlc2NyaXB0b3JzOiBjcH0pO1xuICAgICAgdGhpcy5zdGFjay5leGNoYW5nZUNTUChDb250ZXh0U3RhdGUuT0JKRUNUX1BST1BFUlRZX0VOVU1FUkFUSU9OKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3Qge2tleURlc2NyaXB0b3JzfSA9IHRoaXMuc3RhY2sucG9wQ1AoKTtcbiAgICAgIGRlc2NyaXB0b3JJbmZvID0ga2V5RGVzY3JpcHRvcnMuZGVzY3JpcHRvcnMucG9wKCk7XG4gICAgICB0aGlzLnN0YWNrLnB1c2hDUCh7ZGVzY3JpcHRvckluZm8sIGtleURlc2NyaXB0b3JzfSk7XG4gICAgfVxuXG4gICAgaWYgKGRlc2NyaXB0b3JJbmZvICYmIGRlc2NyaXB0b3JJbmZvLmRlc2NyaXB0b3IpIHtcbiAgICAgIHRoaXMuc3RhY2sucHVzaElQKFRyYXZlcnNhbFN0YXRlLk9CSkVDVF9QUk9QRVJUWV9TVEFSVCk7XG4gICAgICBpZiAoZGVzY3JpcHRvckluZm8uZGVzY3JpcHRvci52YWx1ZSkge1xuICAgICAgICByZXR1cm4ge3ZhbHVlOiBkZXNjcmlwdG9ySW5mby5kZXNjcmlwdG9yLnZhbHVlLCBzdGF0ZTogVHJhdmVyc2FsU3RhdGUuT0JKRUNUX1JPT1R9O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdmFsdWU6IGBcIiR7ZGVzY3JpcHRvckluZm8ubmFtZX1cIjoge1xuICAgICAgICAgIFwiY29uZmlndXJhYmxlXCI6ICR7ZGVzY3JpcHRvckluZm8uZGVzY3JpcHRvci5jb25maWd1cmFibGV9LFxuICAgICAgICAgIFwiZW51bWVyYWJsZVwiOiAke2Rlc2NyaXB0b3JJbmZvLmRlc2NyaXB0b3IuZW51bWVyYWJsZX0sXG4gICAgICAgICAgXCJzZXRcIjogJHt0aGlzLnNlcmlhbGl6ZUZ1bmN0aW9uKGRlc2NyaXB0b3JJbmZvLmRlc2NyaXB0b3Iuc2V0KX0sXG4gICAgICAgICAgXCJnZXRcIjogJHt0aGlzLnNlcmlhbGl6ZUZ1bmN0aW9uKGRlc2NyaXB0b3JJbmZvLmRlc2NyaXB0b3IuZ2V0KX1cbiAgICAgICAgfWAsXG4gICAgICAgIHN0YXRlOiBudWxsXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4ge3ZhbHVlOiBudWxsLCBzdGF0ZTogVHJhdmVyc2FsU3RhdGUuT0JKRUNUX1BST1BFUlRZX0VORH07XG4gIH1cblxuXG4gIHByaXZhdGUgc2VyaWFsaXplRnVuY3Rpb24oZm46IEZ1bmN0aW9uKSB7XG4gICAgaWYgKGZuKSB7XG4gICAgICBjb25zdCBzdHIgPSBGdW5jdGlvbi5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChmbikucmVwbGFjZSgvXFxuXFxzL2csICcnKTtcbiAgICAgIGlmICgvXmZ1bmN0aW9uKCl7W25hdGl2ZSBjb2RlXX0kLy50ZXN0KHN0cikpIHtcbiAgICAgICAgcmV0dXJuICdmdW5jdGlvbigpIHt0aHJvdyBuZXcgRXJyb3IoXCJOYXRpdmUgZnVuY3Rpb24gb3IgYm91bmQgZnVuY3Rpb24gY2FuXFwndCBzZXJpYWxpemUuXCIpfSdcbiAgICAgIH1cbiAgICAgIHJldHVybiBgXCIke3N0cn1cImA7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXJpYWxpemVSZWdleHAocmVnZXhwOiBSZWdFeHApIHtcbiAgICByZXR1cm4gYHtcInR5cGVcIjpcInJlZ2V4cFwiLCBcInZhbHVlXCI6IFwiLyR7cmVnZXhwLnNvdXJjZX0vJHtyZWdleHAuZmxhZ3N9XCJ9YFxuICB9XG5cblxuICAvKipcbiAgICogU2VyaWFsaXplIHByaW1pdGl2ZSB2YWx1ZXMuXG4gICAqIFJFVFVSTiBsYXN0IHZwXG4gICAqL1xuICBwcml2YXRlIGhhbmRsZVByaW1pdGl2ZVNlcmlhbGl6YXRpb24ob2JqOiBhbnksIHNlcmlhbGl6ZTogKHY6IGFueSkgPT4gc3RyaW5nKTogdm9pZCB7XG4gICAgc3dpdGNoICh0aGlzLnN0YWNrLnBlZWtDU1AoKSkge1xuICAgIGNhc2UgQ29udGV4dFN0YXRlLk9CSkVDVF9QUk9QRVJUWV9FTlVNRVJBVElPTjoge1xuICAgICAgY29uc3Qge2Rlc2NyaXB0b3JJbmZvfSA9IHRoaXMuc3RhY2sucGVla0NQKCk7XG4gICAgICBjb25zdCByZXQgPSBgXCIke2Rlc2NyaXB0b3JJbmZvLm5hbWV9XCI6IHtcbiAgICAgICAgXCJjb25maWd1cmFibGVcIjogJHtkZXNjcmlwdG9ySW5mby5kZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZX0sXG4gICAgICAgIFwiZW51bWVyYWJsZVwiOiAke2Rlc2NyaXB0b3JJbmZvLmRlc2NyaXB0b3IuZW51bWVyYWJsZX0sXG4gICAgICAgIFwid3JpdGFibGVcIjogJHtkZXNjcmlwdG9ySW5mby5kZXNjcmlwdG9yLndyaXRhYmxlfSxcbiAgICAgICAgXCJ2YWx1ZVwiOiAke3NlcmlhbGl6ZShvYmopfVxuICAgICAgfWAucmVwbGFjZSgvXFxzL2csICcnKTtcbiAgICAgIHRoaXMuc3RhY2suZXhjaGFuZ2VWUChyZXQpO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGNhc2UgQ29udGV4dFN0YXRlLkFSUkFZOlxuICAgIGNhc2UgQ29udGV4dFN0YXRlLk9SRElOQUw6IHtcbiAgICAgIHRoaXMuc3RhY2suZXhjaGFuZ2VWUChzZXJpYWxpemUob2JqKSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgfVxuICB9XG59XG4iXX0=
